{% extends "base.html" %}

{% block content %}

<!-- Main user Profile -->
<div id = "viewer" style="display: none;">{{viewer.username}}</div>
<img src="/img?user_id={{user.key.urlsafe}}"
class="img-rounded"/>
<div class="page-header">


  <!-- Edit information -->
  <div class = "row">
    <div class = "col-md-12">
      <form class = "form-inline" action = "/updateprofile" method = "post" style = "display: none;" id = "editField">
        <div class = "col-md-2">
          <input name = "first" type = "text" class="form-control input-default" style="width: 100%;" value ="{{user.first_name}}">
        </div>
        <div class = "col-md-2">
          <input name = "last" type = "text" class="form-control input-default" style="width: 100%;" value ="{{user.last_name}}">
        </div>
        <div class = "col-md-2">
          <input name = "profession" type = "text" class="form-control input-default" style="width: 100%;" value ="{{user.profession}}">
        </div>
        <div class = "col-xs-1 text-center"><h4>at</h4></div>
        <div class = "col-md-3">
          <input name = "employer" type = "text" class="form-control input-default" style="width: 100%;" value ="{{user.employer}}">
          <input name="user_key" type="hidden" value="{{user.key.urlsafe}}">
        </div>
        <div class = "col-md-1"><button class = "btn btn-warning" id="cancel" type="reset">Cancel</button></div>
        <div class = "col-md-1"><button class = "btn btn-primary" id = "save" type="submit">Save</button></div>
      </form>
    </div>
  </div>
  <!-- End edit information -->


  <h2 id= "test" >{{user.first_name}} {{user.last_name}}
    <small id = "profession">      {{user.profession}}    </small>
    <small> @ </small>
    <small id = "employer">     {{user.employer}}</small>
    {% if user.email_address != viewer.email_address %}
    <form role="form-horizontal" action="/connect" method="post">
      <div class="form-group">
        <input  type="hidden" name="requestee" class="btn btn-primary" value={{user.username}}>
      </div>
      {% if viewer.key not in user.friends %}
      <!-- IF USER IS NOT FRIENDS -->
      <button type="submit" class="btn btn-primary">
        <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>          Connect
      </button>
      {% endif %}
      <!-- <a href="/compose?recipient={{user.username}}" type="button" class="btn btn-primary">
        <span class="glyphicon glyphicon-envelope" aria-hidden="true"></span>          Message
      </a> -->

      <!-- Notes:
      Here is the button to create a modal message.
      What works: Modal created and recipient is carried over.
      What doesn't: jquery gets all fields, but doesn't send them to composemessage -->

      <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#messageModal" data-recipient={{user.username}}><span class="glyphicon glyphicon-envelope" aria-hidden="true"></span>  Message</button>
    </form>
</div>
      <!-- NEW MESSAGE SELECTED -->

      <!-- NEW MESSAGE MODAL SELECTED -->
      <div class="modal fade" id="messageModal" tabindex="-1" role="dialog" aria-labelledby="messageLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
              <h4 class="modal-title" id="messageLabel">New message</h4>
            </div>
            <div class="modal-body">
              <form>
                <div class="form-group">
                  <label for="recipient-name" class="control-label">Recipient:</label>
                  <input type="text" class="form-control input-lg" id="recipient">
                </div>
                <div class = "form-group">
                  <label for="message-subject" class="control-label">Subject:</label>
                  <input class = "form-control input-lg" id="message-subject"></input>
                </div>
                <div class="form-group">
                  <label for="message-text" class="control-label">Message:</label>
                  <textarea class="form-control" id="message-text" rows="10"></textarea>
                </div>
               </form>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
              <button type="submit" class="btn btn-primary" id="sendMessage">Send message</button>
            </div>
          </div>
        </div>
      </div>
      <script type="text/javascript" src="/js/newMessage.js"> </script>
      
    {% else %}
    <!-- User owns profile -->
      <button type="button" class="btn btn-primary pull-right" align="right" id="edit">
      <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>   Edit</button>
      
      <!-- Modal -->
      <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="container">
          <div class="row form-group">
            <!-- Main tabs -->
            <div class="col-xs-12">
              <ul class="nav nav-pills nav-justified thumbnail setup-panel">
                <li class="active"><a href="#step1">
                  <h4 class="list-group-item-heading">Role</h4></a>
                </li>
                <li class="disabled"><a href="#step2">
                  <h4 class="list-group-item-heading">Specialty</h4></a>
                </li>
                <li class="disabled"><a href="#step3">
                  <h4 class="list-group-item-heading">Skills</h4></a>
                </li>
                </ul>
            </div>
          </div>
          <!-- What field -->
          <div class="row setup-content" id="step1">
            <div class="col-xs-12">
              <div class="col-md-2"></div>
              <div class="col-md-8 well">
                <div class="page-header"><h1>My role in tech is  <span id="role">___________</span>  related.</h1></div>
                <div class="checkbox">
                <label><input type="radio" id="business"> Business</label></div>
                <div class="checkbox">
                <label><input type="radio" id="tech"> Engineering</label></div>
                <h3/>
                <button id="activate2" class="btn btn-primary btn-lg pull-right">Next</button>
              </div>
              <div class="col-md-2"></div>
            </div>
          </div>
          <!-- Tech - Question 2 -->
          <div class="row setup-content" id="step2">
            <div class="col-xs-12">
              <div class="col-md-2"></div>
              <div class="col-md-8 well">
                <div class="page-header"><h1>Do you code?</h1></div>
                <div class="checkbox">
                <label><input type="radio" id="yes"> Yes</label></div>
                <div class="checkbox">
                <label><input type="radio" id="no"> No</label></div>
                <h3/>
                <button id="activate3" class="btn btn-primary btn-lg pull-right">Next</button>
              </div>
              <div class="col-md-2"></div>
            </div>
          </div>
          <!-- Tech - Question 3 -->
          <div class="row setup-content" id="step3">
            <div class="col-xs-12">
             <div class="col-md-12 well">
                <div class="page-header"><h1>What type of Developer?</h1></div>
                <div class="checkbox">
                <label><input type="radio" id="mobile"> Mobile Applications</label></div>
                <div class="checkbox">
                <label><input type="radio" id="system"> Systems</label></div>
                <div class="checkbox">
                <label><input type="radio" id="web"> Web</label></div>
                <div class="checkbox">
                <label><input type="radio" id="embedSystem"> Embedded Systems</label></div>
                <div class="checkbox">
                <label><input type="radio" id="bigdata"> Big Data</label></div>
                <div class="checkbox">
                <label><input type="radio" id="quality"> Quality Assurance</label></div>
                <h3/>
                <button id="done" class="btn btn-primary btn-lg pull-right" data-dismiss="modal">Done</button>
              </div>
            </div>
          </div>
        </div>
      </div>
  </h2>
</div>

<!-- User engagement Questionnaire -->
<script type="text/javascript" src="../js/engagement.js"> </script>

    {% endif %}

<!-- END MODAL -->
        <div class="row">
          <div class="col-md-4">
            <ul class="list-group">
            <a class="list-group-item" href="/connections?username={{user.username}}">
              Connections
              {% if user.friend_count > 0 %}
              <span class="badge">{{user.friend_count}}</span>
              {% endif %}
            </a>
            <a class="list-group-item" href="/connections?username={{user.username}}">
              Projects
              <span class="badge">1690</span>
            </a>
            <a class="list-group-item" href="/connections?username={{user.username}}">
              Hacks
            <span class="badge">15</span>
            </a>
            <a class="list-group-item" href="/connections?username={{user.username}}">
              Skills
            <span class="badge">14</span>
            </a>
            </ul>
          </div>

          <div class="col-md-2"></div>

          <div class="col-md-6">
            <div class="panel panel-default">
              <div class="panel-heading">
                <h3 class="panel-title">Comment</h3>
              </div>
              <div class="panel-body">
                <form role="form" action="/comment" method="post">
                  <div class="form-group">
                    <textarea style="resize:none; font-size: 16px;" name="text" class="form-control" rows="1" id="commentBox"></textarea>
                    <ol style="visibility:hidden;"></ol>
                    <input  type="hidden" name="recipient" class="form-control" value={{user.username}}>
                    <input  type="hidden" name="sender" class="form-control" value={{viewer.username}}>
                    <button type="submit" style="display:none;" class="btn btn-primary pull-right" id="postButton"><span class="glyphicon glyphicon-comment" aria-hidden="true"></span>  Post</button>
                  </div>
                </form>
              </div>
            </div>
            <div class="list-group">
              {% for comment in comments %}
              <div class="panel panel-info">
                <div class="panel-heading">
                  <h2 class="panel-title">{{comment.sender}}<span><p class="panel-title pull-right">{{comment.time}}</p></span></h2>
                </div>
                <div class="panel-body">
                  <h4>{{comment.text}}</h4>
                </div>
              </div>
       {% endfor %}
     </div>
   </div>
 </div>

<!-- Comment JS -->
<script type="text/javascript" src="../js/comment.js"> </script>

{% endblock %}
